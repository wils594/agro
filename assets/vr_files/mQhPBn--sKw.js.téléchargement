;/*FB_PKG_DELIM*/

__d("WAWebPipMsgVideoTag.react",["WAWebCometVideoPlayerUtils","WAWebMsgGetters","WAWebPipUrlVideoTagLoadable.react","WAWebUserPrefsGeneral","WAWebVideoUtils","react","useMergeRefs","useWAWebCanPlaybackAudio","useWAWebCometVideoPlayerStateMachine","useWAWebModelValues","useWAWebMsgValues","useWAWebOnUnmount","useWAWebStableCallback"],(function(t,n,r,o,a,i,l){var e=["ref"],s,u,c=u||(u=o("react")),d=s||(s=r("react")),m=c.useCallback,p=c.useEffect,_=c.useRef;function f(t){var n=t.ref,a=babelHelpers.objectWithoutPropertiesLoose(t,e),i=a.onLoadedMetadata,l=o("useWAWebMsgValues").useMsgValues(a.msg.id,[o("WAWebMsgGetters").getId]),s=l[0],u=o("useWAWebModelValues").useModelValues(a.mediaData,["mediaBlob","streamable","aspectRatio"]),c=_(null),f=r("useMergeRefs")(n,c),g=r("useWAWebCometVideoPlayerStateMachine")(babelHelpers.extends({},o("WAWebCometVideoPlayerUtils").getChannelMediaMetadataForSNAPL(a.msg),{isCopyrightMuted:!o("useWAWebCanPlaybackAudio").useCanPlaybackAudio(a.msg),videoOrigin:a.msg.getWamMessageType()})),h=g.callbacks,y=g.handleReactEffectCleanup,C=g.handleReactEffectInit,b=g.videoElementRefCallback;p(function(){C()},[C]),r("useWAWebOnUnmount")(function(){y()});var v=r("useWAWebStableCallback")(function(e){if(c.current!==e){var t=e==null?void 0:e.underlyingVideo();if(t!=null&&b(t),f(e),e){var n=o("WAWebUserPrefsGeneral").getMediaVolumeSettings(),r=n.muted,a=n.volume;a!=null&&e.setVolume(a),e.setMuted(r)}}}),S=m(function(e,t){var n=u.aspectRatio,r=e.videoWidth!==0&&e.videoHeight!==0?e.videoWidth/e.videoHeight:void 0;(!n&&r!=null&&r!==0||n&&r!=null&&r!==0&&Math.abs(r-n)>.01)&&u.set({aspectRatio:r}),i(e,t)},[u,i]),R=o("WAWebVideoUtils").getVideoUrl(a.msg,u);return d.jsx(o("WAWebPipUrlVideoTagLoadable.react").UrlVideoTagLoadable,{msg:a.msg,ref:v,url:R,startTime:a.startTime,poster:a.poster,className:a.className,onVolumeChange:a.onVolumeChange,onEnded:a.onEnded,onError:a.onError,onPause:a.onPause,onPlaying:a.onPlaying,onProgress:a.onProgress,onTimeUpdate:a.onTimeUpdate,onLoadedMetadata:S,autoPlay:a.autoPlay,onCanPlay:a.onCanPlay,onLoadedData:a.onLoadedData,onWaiting:a.onWaiting,callbacks:h,children:a.children})}f.displayName=f.name+" [from "+i.id+"]",l.default=f}),98);